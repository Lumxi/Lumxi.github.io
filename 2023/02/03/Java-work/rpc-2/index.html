<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="从零开始实现一个简单的RPC框架(2), 后端工程师之路">
    <meta name="description" content="1. Socket通信实战什么是Socket
在计算机网络中,Socket被描述为一个抽象的关键字,由IP+port组成,它描述了TCP连接的一个对等端
如果要通过互联网进行通信,则至少需要一对套接字

运行于服务器的Server Sock">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>从零开始实现一个简单的RPC框架(2) | 后端工程师之路</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.3.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">后端工程师之路</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">后端工程师之路</div>
        <div class="logo-desc">
            
            华南农业大学软件工程学生博客
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/18.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">从零开始实现一个简单的RPC框架(2)</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Java/">
                                <span class="chip bg-color">Java</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/java%E5%9F%BA%E7%A1%80/" class="post-category">
                                java基础
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-02-03
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="1-Socket通信实战"><a href="#1-Socket通信实战" class="headerlink" title="1. Socket通信实战"></a>1. Socket通信实战</h2><p><strong>什么是Socket</strong></p>
<p>在计算机网络中,<code>Socket</code>被描述为一个抽象的关键字,由<code>IP+port</code>组成,它描述了<code>TCP</code>连接的一个对等端</p>
<p>如果要通过互联网进行通信,则至少需要一对套接字</p>
<ul>
<li>运行于服务器的<code>Server Socket</code></li>
<li>运行于客户端的<code>Client Server</code></li>
</ul>
<p><img src="data:image/png;base64,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"></p>
<p>这个图描述了<code>TCP</code>三次握手-&gt;传输数据-&gt;<code>TCP</code>四次挥手的过程</p>
<p><code>client</code>实际上并不需要指定端口,因为有默认端口的设定,它会在<code>TCP</code>的首部中进行描述,而它需要指定的是,你这个消息要发往哪个目的主机和哪个端口,这样对方的服务器才能够通过此端口接收数据</p>
<p><code>server</code>需要选择监听哪个端口,才能正确接收数据,由于发过来的<code>TCP</code>报文段中具有对方的源地址和源端口信息,因此在回送的时候可以直接根据头部信息获取回送的路径</p>
<p><strong>BIO:简单的EchoServer实现</strong></p>
<p>BIO的实现思路是使用阻塞式的IO输入,只有当双方都完成IO后,连接才会断开,阻塞的时机是在<code>accept()</code>中,只有当接收到数据后,线程才会继续向下执行代码</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ServerSocket</span> serverSocket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerSocket</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//2. 通过accept监听客户端发送过来的请求</span>
<span class="token class-name">Socket</span> socket<span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>socket <span class="token operator">=</span> serverSocket<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token comment">//3. 通过输入流读取客户端发送过来的信息</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"客户端已经连接"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">OutputStream</span> outputStream <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ObjectInputStream</span> objectInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ObjectOutputStream</span> objectOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span>outputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Object</span> message <span class="token operator">=</span> objectInputStream<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"接收到的信息是&#123;&#125;"</span><span class="token punctuation">,</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//4. 通过输出流回送信息</span>
    objectOutputStream<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span><span class="token string">"end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    objectOutputStream<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果要进行修正,那么可以引入一个线程池</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> log <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">EchoServerTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 服务端开始监听
 * @param port
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token keyword">int</span> port<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token comment">//1. 创建ServerSocket,并且监听一个端口</span>
    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">ServerSocket</span> serverSocket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerSocket</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2. 通过accept监听客户端发送过来的请求</span>
        <span class="token class-name">Socket</span> socket<span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>socket <span class="token operator">=</span> serverSocket<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"处理的线程ID是&#123;&#125;"</span><span class="token punctuation">,</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//3. 通过输入流读取客户端发送过来的信息</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"客户端已经连接"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">OutputStream</span> outputStream <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">ObjectInputStream</span> objectInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">ObjectOutputStream</span> objectOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span>outputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Object</span> message <span class="token operator">=</span> objectInputStream<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"接收到的信息是&#123;&#125;"</span><span class="token punctuation">,</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//4. 通过输出流回送信息</span>
            objectOutputStream<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span><span class="token string">"end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            objectOutputStream<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//1.创建线程池</span>
    <span class="token class-name">ThreadFactory</span> threadFactory <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">defaultThreadFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ExecutorService</span> threadPool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MINUTES</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">ArrayBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>threadFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    threadPool<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"创建新的线程,线程ID：&#123;&#125;"</span><span class="token punctuation">,</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">start</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>BIO的最大痛点是:处理线程和请求数是1:1的出现的,其关键在于监听请求和处理请求都是同一个线程完成的</p>
<p>尽管引入了线程池,但是当线程数量过多的时候,也会导致程序的崩溃,因此我们应该尽可能的减少线程的使用,一个办法是将监听请求的线程和处理请求的线程给解耦,有一个线程专门负责请求的接收,然后将此请求分发到下面的子线程进行处理</p>
</blockquote>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">threadPool<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"处理的线程ID是&#123;&#125;"</span><span class="token punctuation">,</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//3. 通过输入流读取客户端发送过来的信息</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"客户端已经连接"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
        inputStream <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">OutputStream</span> outputStream <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ObjectInputStream</span> objectInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ObjectOutputStream</span> objectOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span>outputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> message <span class="token operator">=</span> objectInputStream<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"接收到的信息是&#123;&#125;"</span><span class="token punctuation">,</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//4. 通过输出流回送信息</span>
        objectOutputStream<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span><span class="token string">"end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        objectOutputStream<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>经过我自己的测试,当线程数达到十万级别的时候,CPU飙到了百分之90,而这仅仅只是传送一个<code>end</code>而已,而且还有很多请求被丢掉了,性能实在太差</p>
<p>于是引入了<code>NIO</code></p>
<h2 id="2-Netty入门实战"><a href="#2-Netty入门实战" class="headerlink" title="2. Netty入门实战"></a>2. Netty入门实战</h2><p><code>Netty</code>成功找到了一种方式,使得在不妥协可维护性和性能情况下实现易于开发,性能,稳定性和灵活性的方式</p>
<p>首先定义<code>RPC</code>通信对象</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RpcRequest</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> interfaceName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> methodName<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RpcResponse</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>初始化客户端程序</strong></p>
<p>客户端的职责:用一个向服务端发送消息的<code>sendMessage()</code>方法,通过此方法可以将消息也就是<code>RpcRequest</code>对象发送到服务端,并且可以同步获取到服务端返回的结构,也就是<code>RpcResponse</code></p>
<p>我们来看看初始化的时候,都做了一些什么:</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Bootstrap</span> b<span class="token punctuation">;</span>

<span class="token comment">//初始化相关资源</span>
<span class="token keyword">static</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">EventLoopGroup</span> eventLoopGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//初始化序列化器</span>
    <span class="token class-name">KryoSerializer</span> kryoSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KryoSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span>eventLoopGroup<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token class-name">NioSocketChannel</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LoggingHandler</span><span class="token punctuation">(</span><span class="token class-name">LogLevel</span><span class="token punctuation">.</span><span class="token constant">INFO</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token class-name">ChannelOption</span><span class="token punctuation">.</span><span class="token constant">CONNECT_TIMEOUT_MILLIS</span><span class="token punctuation">,</span><span class="token number">5000</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChannelInitializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SocketChannel</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">initChannel</span><span class="token punctuation">(</span><span class="token class-name">SocketChannel</span> socketChannel<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
                    <span class="token comment">//自定义序列化编码器</span>
                    <span class="token comment">//RpcResponse->ByteBuf</span>
                    socketChannel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">//ByteBuf->RpcRequest</span>
                    socketChannel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    socketChannel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>有很多不认识的东西,我们先来认识一下这些东西</p>
<p><code>Bootstrap</code>:它是启动引导类,它是客户端&#x2F;服务端启动的时候的辅助类,它的作用是规定了连接的端口以及处理<code>I/O</code>,接收<code>I/O</code>请求的规则,</p>
<p><code>EventLoopGroup</code>:它相当于一个线程组,<code>EventLoop</code>相当于一个处理线程,那么<code>group</code>就相当于一个线程池,Netty用来处理请求的线程就来自于这个参数,就相当于,它是一个施工队,当需要干活的人从里面挑工人出去干活</p>
<p><code>channel</code>:是代表连接的类型,比如说是<code>TCP</code>连接?还是<code>UDP</code>等</p>
<p><code>handler</code>:消息处理器,代表当请求到来的时候如何处理请求,它就类似于工程师,专门设计方案的,设计出来后,交给施工队进行处理,施工队拿着图纸开始施工</p>
<p><code>初始化通道处理器的过程之后再讲</code>,这里先看编码器</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NettyKryoEncoder</span> <span class="token keyword">extends</span> <span class="token class-name">MessageToByteEncoder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Serializer</span> serializer<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> genericClass<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">encode</span><span class="token punctuation">(</span><span class="token class-name">ChannelHandlerContext</span> channelHandlerContext<span class="token punctuation">,</span> <span class="token class-name">Object</span> o<span class="token punctuation">,</span> <span class="token class-name">ByteBuf</span> byteBuf<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>genericClass<span class="token punctuation">.</span><span class="token function">isInstance</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token comment">//1.将对象转化为Byte</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> serialize <span class="token operator">=</span> serializer<span class="token punctuation">.</span><span class="token function">serialize</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//2. 读取消息的长度</span>
            <span class="token keyword">int</span> dataLength <span class="token operator">=</span> serialize<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
            <span class="token comment">//3. 写入消息长度</span>
            byteBuf<span class="token punctuation">.</span><span class="token function">writeInt</span><span class="token punctuation">(</span>dataLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//4. 写入消息</span>
            byteBuf<span class="token punctuation">.</span><span class="token function">writeBytes</span><span class="token punctuation">(</span>serialize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NettyKryoDecoder</span> <span class="token keyword">extends</span> <span class="token class-name">ByteToMessageDecoder</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Serializer</span> serializer<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> genericClass<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">BODY_LENGTH</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token class-name">ChannelHandlerContext</span> channelHandlerContext<span class="token punctuation">,</span> <span class="token class-name">ByteBuf</span> byteBuf<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> list<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>byteBuf <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> byteBuf<span class="token punctuation">.</span><span class="token function">readableBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token constant">BODY_LENGTH</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token comment">//1.读取消息的长度</span>
        byteBuf<span class="token punctuation">.</span><span class="token function">markReaderIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> dataLength <span class="token operator">=</span> byteBuf<span class="token punctuation">.</span><span class="token function">readInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2.参数校验</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>dataLength <span class="token operator">&lt;</span><span class="token number">0</span> <span class="token operator">||</span> byteBuf<span class="token punctuation">.</span><span class="token function">readableBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token comment">//3.如果可读的字节数小于消息长度的话也是不合理的</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>dataLength <span class="token operator">></span> byteBuf<span class="token punctuation">.</span><span class="token function">readableBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token comment">//那么这时候只能放弃解码,重置读指针,还原本次的修改,等待下一次的I/O</span>
            byteBuf<span class="token punctuation">.</span><span class="token function">resetReaderIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>dataLength<span class="token punctuation">]</span><span class="token punctuation">;</span>
        byteBuf<span class="token punctuation">.</span><span class="token function">readBytes</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//反序列化</span>
        <span class="token class-name">Object</span> target <span class="token operator">=</span> serializer<span class="token punctuation">.</span><span class="token function">deserialize</span><span class="token punctuation">(</span>body<span class="token punctuation">,</span> genericClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"反序列化完成"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>技术点:这里解决了粘包和半包的问题</strong></p>
<p>粘包的话会导致消息的长度&lt;字节数组的长度,这里的话用的方案是提供读取长度的方案。</p>
<p>那么为什么<code>Handler</code>上要注册这几个东西呢?</p>
<p>我们先来回顾一下,在连接上,我们到底在做什么?</p>
<p>首先对于客户端而言,它的工作是将<code>自己产生的RpcRequest</code>发送到服务端对吧?</p>
<blockquote>
<p>那么在这个过程中,通道上需要有一个方法支持,它支持将这个对象编码为二进制字符串,因此需要注册<code>、、Encoder</code>方法</p>
</blockquote>
<p>第二个,客户端还需要解码来自于服务端的消息</p>
<blockquote>
<p>因此通道上需要注册一个将二进制字符串为对象的方法</p>
</blockquote>
<p>第三个,客户端获取到了一个响应,那这个响应要放到哪里去?</p>
<blockquote>
<p>一个通道内的数据通常应该是共享的,因此设计了<code>通道域</code>,将通道中的信息放到一个容器中,对于调用方,只要访问这个容器就能取到数据了</p>
</blockquote>
<p>我们可以看到,这上面的三个环节实际上是环环相扣的,也就是每一部分的工作都由专人负责</p>
<p><strong>技术点:使用责任链模式解耦合编码&#x2F;解码&#x2F;数据存取工作</strong></p>
<p>至此,客户端就初始完毕了</p>
<p><strong>接下来是核心部分,就是规定客户端如何收发数据</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">RpcResponse</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token class-name">RpcRequest</span> rpcRequest<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token comment">//1.建立连接,并且获取连接对象数据</span>

    <span class="token comment">//2.建立连接成功,向通道中写入数据</span>

    <span class="token comment">//3.监听返回状态</span>

    <span class="token comment">//4.返回信息成功,从通道中取出返回值</span>

    <span class="token comment">//5.返回信息失败,显示错误信息</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>大致流程如上,接下来我们借助于netty进行实现</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">RpcResponse</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token class-name">RpcRequest</span> rpcRequest<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//1.建立连接,并且获取连接对象数据</span>
        <span class="token class-name">ChannelFuture</span> channelFuture <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//1.1 获取通道描述对象</span>
        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> channelFuture<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>channel <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">//2.建立连接成功,向通道中写入数据,并且监听发送状态</span>
            channel<span class="token punctuation">.</span><span class="token function">writeAndFlush</span><span class="token punctuation">(</span>rpcRequest<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>future <span class="token operator">-></span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>future<span class="token punctuation">.</span><span class="token function">isSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"客户端成功发送了信息,请求信息是:&#123;&#125;"</span><span class="token punctuation">,</span>rpcRequest<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
                    log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"客户端发送信息失败!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//3.等待服务端返回信息,当信息传递完毕后通道关闭,因此我们监听通道的存活状态</span>
            channel<span class="token punctuation">.</span><span class="token function">closeFuture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//4.通道关闭,数据应当已经写入到了通道域中</span>
            <span class="token class-name">AttributeKey</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">RpcResponse</span><span class="token punctuation">></span></span> key <span class="token operator">=</span> <span class="token class-name">AttributeKey</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token string">"rpcResponse"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//4.返回信息成功,取出返回值</span>
            <span class="token keyword">return</span> channel<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//5.返回信息失败,显示错误信息</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>服务端开发</strong></p>
<p>首先服务端的架构是基于<code>IO多路复用</code>的架构,这个架构的特点是</p>
<ul>
<li>有一个主线程,该主线程负责接收请求,并且把请求分发到下属的工作线程</li>
<li>工作线程完成任务后,将任务结果通知主线程,主线程将结果返回给客户端</li>
</ul>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//1.主线程</span>
    <span class="token class-name">EventLoopGroup</span> bossGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//2.工作者线程</span>
    <span class="token class-name">EventLoopGroup</span> workerGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//3.序列化器实现</span>
    <span class="token class-name">KryoSerializer</span> kryoSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KryoSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span><span class="token punctuation">&#123;</span>
        <span class="token comment">//4.初始化引导器</span>
        <span class="token class-name">ServerBootstrap</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        b<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span>bossGroup<span class="token punctuation">,</span>workerGroup<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token class-name">NioServerSocketChannel</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token comment">//注册通道类型</span>
                <span class="token punctuation">.</span><span class="token function">childOption</span><span class="token punctuation">(</span><span class="token class-name">ChannelOption</span><span class="token punctuation">.</span><span class="token constant">TCP_NODELAY</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token comment">//注册每一个channel的TCP策略</span>
                <span class="token punctuation">.</span><span class="token function">childOption</span><span class="token punctuation">(</span><span class="token class-name">ChannelOption</span><span class="token punctuation">.</span><span class="token constant">SO_KEEPALIVE</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token class-name">ChannelOption</span><span class="token punctuation">.</span><span class="token constant">SO_BACKLOG</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LoggingHandler</span><span class="token punctuation">(</span><span class="token class-name">LogLevel</span><span class="token punctuation">.</span><span class="token constant">INFO</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">childHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChannelInitializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SocketChannel</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//每一个channel的处理策略</span>
                    <span class="token annotation punctuation">@Override</span>
                    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">initChannel</span><span class="token punctuation">(</span><span class="token class-name">SocketChannel</span> socketChannel<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
                        socketChannel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        socketChannel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        socketChannel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>

    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>依然的是有很多东西看不懂,下面一个个的进行解读</p>
<p><strong>为什么客户端的初始化是在静态块中进行初始化,那到服务器上就变成了实例了?</strong></p>
<p>这个与功能有关</p>
<p>客户端的引导器在初始化的时候并不需要知道对方的IP和port,只有当发起调用的时候才需要知道,因此引导器的初始化放在<code>static</code>和<code>实例中</code>均能够完成初始化,选择在<code>static</code>中能够加速首次调用,但是会降低整个服务的启动速度</p>
<p>服务端的引导器在初始化的时候就必须绑定端口号,但是端口号是程序设定的,一般来说,只有在程序准备完毕后才会执行开启服务的调用,如果在类初始化时就开启调用,可能导致错误的发生</p>
<p><strong>child和非child有什么区别?</strong></p>
<p>从架构上来看,是一个主线程下分配若干个子线程去真正的在<code>Channel</code>中处理数据,因此需要额外配置每个子线程的和子通道的处理策略</p>
<p><code>ChannelOption.TCP_NODELAY</code></p>
<p>它意味着开启了Nagle算法,该算法的作用是尽可能快的发送大数据块,减少网络的传输量,这个参数的作用当为true的时候,就开启了<code>Nagle</code>算法</p>
<p><code>ChannelOption.SO_KEEPALIVE</code></p>
<p>它意味着开启了TCP底层的保活机制,避免客户端关闭后占用线程资源</p>
<p><code>ChannelOption.SO_BACKLOG</code></p>
<p>它表示TCP连接队列的数量,如果连接建立频繁,服务器处理新连接比较慢,可以适当调大这个参数</p>
<p><strong>然后是子线程的处理机制我们要怎么设计?</strong></p>
<p>从通道中接收到一个数据,工作是</p>
<ul>
<li>将二进制串解码,还原对象</li>
<li>执行方法</li>
<li>将产生的响应对象编码,发送到通道中</li>
</ul>
<p>于是设计为:</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token punctuation">.</span><span class="token function">childHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChannelInitializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SocketChannel</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">initChannel</span><span class="token punctuation">(</span><span class="token class-name">SocketChannel</span> socketChannel<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        socketChannel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NettyKryoDecoder</span><span class="token punctuation">(</span>kryoSerializer<span class="token punctuation">,</span> <span class="token class-name">RpcRequest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        socketChannel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NettyKryoEncoder</span><span class="token punctuation">(</span>kryoSerializer<span class="token punctuation">,</span> <span class="token class-name">RpcResponse</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        socketChannel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NettyServerHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>初始化完毕,开启服务端</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//绑定监听端口,同步等待绑定成功</span>
<span class="token class-name">ChannelFuture</span> future <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//等待服务端监听端口关闭</span>
future<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">closeFuture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>完整代码</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">netty<span class="token punctuation">.</span>server</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * Netty发起远程调用的服务端
 *
 * @author: 张庭杰
 * @date: 2023年02月03日 16:40
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NettyServer</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> log <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">NettyServer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> port<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">NettyServer</span><span class="token punctuation">(</span><span class="token keyword">int</span> port<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//监听端口</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>port <span class="token operator">=</span> port<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//1.主线程</span>
        <span class="token class-name">EventLoopGroup</span> bossGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2.工作者线程</span>
        <span class="token class-name">EventLoopGroup</span> workerGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3.序列化器实现</span>
        <span class="token class-name">KryoSerializer</span> kryoSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KryoSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span><span class="token punctuation">&#123;</span>
            <span class="token comment">//4.初始化引导器</span>
            <span class="token class-name">ServerBootstrap</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            b<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span>bossGroup<span class="token punctuation">,</span>workerGroup<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token class-name">NioServerSocketChannel</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token comment">//注册通道类型</span>
                    <span class="token punctuation">.</span><span class="token function">childOption</span><span class="token punctuation">(</span><span class="token class-name">ChannelOption</span><span class="token punctuation">.</span><span class="token constant">TCP_NODELAY</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">childOption</span><span class="token punctuation">(</span><span class="token class-name">ChannelOption</span><span class="token punctuation">.</span><span class="token constant">SO_KEEPALIVE</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token class-name">ChannelOption</span><span class="token punctuation">.</span><span class="token constant">SO_BACKLOG</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LoggingHandler</span><span class="token punctuation">(</span><span class="token class-name">LogLevel</span><span class="token punctuation">.</span><span class="token constant">INFO</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">childHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChannelInitializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SocketChannel</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        <span class="token annotation punctuation">@Override</span>
                        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">initChannel</span><span class="token punctuation">(</span><span class="token class-name">SocketChannel</span> socketChannel<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
                            socketChannel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NettyKryoDecoder</span><span class="token punctuation">(</span>kryoSerializer<span class="token punctuation">,</span> <span class="token class-name">RpcRequest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            socketChannel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NettyKryoEncoder</span><span class="token punctuation">(</span>kryoSerializer<span class="token punctuation">,</span> <span class="token class-name">RpcResponse</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            socketChannel<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NettyServerHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">&#125;</span>
                    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//绑定监听端口,同步等待绑定成功</span>
            <span class="token class-name">ChannelFuture</span> future <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//等待服务端监听端口关闭</span>
            future<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">closeFuture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">//关闭后,执行关闭</span>
            bossGroup<span class="token punctuation">.</span><span class="token function">shutdownGracefully</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            workerGroup<span class="token punctuation">.</span><span class="token function">shutdownGracefully</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>将处理消息的逻辑处理</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//1.获取请求信息</span>
    <span class="token class-name">RpcRequest</span> rpcRequest <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">RpcRequest</span><span class="token punctuation">)</span> msg<span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"接收到了信息&#123;&#125;,次数:&#123;&#125;"</span><span class="token punctuation">,</span>rpcRequest<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token constant">COUNTER</span><span class="token punctuation">.</span><span class="token function">incrementAndGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//2.返回调用信息</span>
    <span class="token comment">//TODO:在本地发起调用...</span>
    <span class="token class-name">RpcResponse</span> rpcResponse <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RpcResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    rpcResponse<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span><span class="token string">"complete!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//3.向通道中写回信息</span>
    <span class="token class-name">ChannelFuture</span> future <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">writeAndFlush</span><span class="token punctuation">(</span>rpcResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
    future<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token class-name">ChannelFutureListener</span><span class="token punctuation">.</span><span class="token constant">CLOSE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">ReferenceCountUtil</span><span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ReferenceCountUtil</span><span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这一句是对不需要消息的收尾,防止触发<code>GC</code>的时候大量消息在<code>JVM</code>中,导致GC缓慢</p>
<p>测试代码</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">new</span> <span class="token class-name">NettyServer</span><span class="token punctuation">(</span><span class="token number">6666</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">RpcRequest</span> rpcRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RpcRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    rpcRequest<span class="token punctuation">.</span><span class="token function">setInterfaceName</span><span class="token punctuation">(</span><span class="token string">"haha"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    rpcRequest<span class="token punctuation">.</span><span class="token function">setMethodName</span><span class="token punctuation">(</span><span class="token string">"haha"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">NettyClient</span> nettyClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NettyClient</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span><span class="token number">6666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">RpcResponse</span> rpcResponse <span class="token operator">=</span> nettyClient<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>rpcRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rpcResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>测试通过</strong></p>
<h2 id="3-网络传输模块分析"><a href="#3-网络传输模块分析" class="headerlink" title="3. 网络传输模块分析"></a>3. 网络传输模块分析</h2><h2 id="4-注册中心模块分析"><a href="#4-注册中心模块分析" class="headerlink" title="4. 注册中心模块分析"></a>4. 注册中心模块分析</h2>
                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">穿山甲</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://lumxi.github.io/2023/02/03/Java-work/rpc-2/">https://lumxi.github.io/2023/02/03/Java-work/rpc-2/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">穿山甲</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Java/">
                                    <span class="chip bg-color">Java</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2023/02/03/Java-work/rpc-1/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/11.jpg" class="responsive-img" alt="从零开始实现一个简单的RPC框架(1)">
                        
                        <span class="card-title">从零开始实现一个简单的RPC框架(1)</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-02-03
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/java%E5%9F%BA%E7%A1%80/" class="post-category">
                                    java基础
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Java/">
                        <span class="chip bg-color">Java</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/02/02/cs-work/cs-work01/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/22.jpg" class="responsive-img" alt="计算机网络知识复习-(1)">
                        
                        <span class="card-title">计算机网络知识复习-(1)</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-02-02
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" class="post-category">
                                    计算机网络
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">
                        <span class="chip bg-color">计算机基础</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2023</span>
            
            <a href="/about" target="_blank">穿山甲</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/blinkfox" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1181062873@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1181062873" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1181062873" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
